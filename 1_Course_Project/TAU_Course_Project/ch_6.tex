\chapter{Стабилизация маятника: LQR и фильтр Калмана}
\label{ch:chap6}

\section{Синтез линейно-квадратичного регулятора}
Синтезируем LQR-регулятор на основе линейной модели (\ref{1_model_lin}).

Зададимся матрицами $Q \succ 0$, $R \succ 0$, чем больше значения первой матрицы, тем выше скорость переходного процесса, второй -- сила управления.

\begin{equation}
    Q = \begin{bmatrix}
10 & 0 & 0 & 0\\
0 & 10 & 0 & 0\\
0 & 0 & 10 & 0\\
0 & 0 & 0 & 10
    \end{bmatrix}, \, \, R = 1
\end{equation}

Синтезируем регулятор, минимизирующий функционал качества

\begin{equation}
	J = \int \limits_0^\infty (x^T(t)Qx(t) + u^T(t)Ru(t))dt
\end{equation}
путем решения соответствующего матричного уравнения Риккати при $\nu=1$:

\begin{equation}
	\begin{cases}
		A^TP+PA+Q-\nu PBR^{-1}B^TP = 0,\\
		K = -R^{-1}B^TP
	\end{cases}
\end{equation}

И получим следующее значение матрицы $K$

\begin{equation}
	K = \begin{bmatrix}
		3.2 &   44.3 &  -5720.8   &-2369.3
	\end{bmatrix}
\end{equation}
применим данный регулятор для управления нелинейной системой (\ref{1_model_full}), задавшись начальными условиями $x(0) = [0.01, \, 0.01, \, 0.01, \, 0.01]$, рисунок \ref{6_lqr_1}. Как видим, ситема стабилизируется, причем компоненты вектора $x(t)$ сходятся к нулю за разное время.

\begin{figure}[!h]
	\center{\includegraphics[width=1\linewidth]{pic2/6_lqr_1.png}}
	\caption{Графики $x(t)$ для нелинейной системы.}
	\label{6_lqr_1}
\end{figure}

Исследуем работоспособность синтезированного регулятора при управлении нелинейной системой в зависимости от начальных условий.
\begin{equation*}
	\begin{matrix}
		x(0) = \begin{bmatrix}
			0.01 & 3 & 0.01 & 0.01
		\end{bmatrix}, & x(0) = \begin{bmatrix}
			0.01 & 0.01 & 0.01 & 1.5
		\end{bmatrix},\\
		x(0) = \begin{bmatrix}
			0.01 & 0.01 & \pi /6 & 0.01
		\end{bmatrix}, & x(0) = \begin{bmatrix}
			5 & 0.01 & 0.01 & 0.1
		\end{bmatrix},\\ 
	\end{matrix}
\end{equation*}


\begin{figure}[!h]
	\center{\includegraphics[width=1\linewidth]{pic2/6_lqr_n1.png}}
	\caption{Графики $x(t)$ для нелинейной системы при $x(0)=[0.01, \, \, 3, \, \, 0.01, \, \, 0.01]$.}
	\label{6_lqr_n1}
\end{figure}


\begin{figure}[!h]
	\center{\includegraphics[width=1\linewidth]{pic2/6_lqr_n2.png}}
	\caption{Графики $x(t)$ для нелинейной системы при $x(0)=[0.01, \, \, 0.01, \, \, 0.01, \, \, 1.5]$.}
	\label{6_lqr_n2}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=1\linewidth]{pic2/6_lqr_n3.png}}
	\caption{Графики $x(t)$ для нелинейной системы при $x(0)=[0.01, \, \, 0.01, \, \, \pi / 6, \, \, 1.5]$.}
	\label{6_lqr_n3}
\end{figure}

\begin{figure}[!h]
	\center{\includegraphics[width=1\linewidth]{pic2/6_lqr_n4.png}}
	\caption{Графики $x(t)$ для нелинейной системы при $x(0)=[5, \, \, 0.01, \, \, 0.01, \, \, 1.5]$.}
	\label{6_lqr_n4}
\end{figure}

\newpage
\,
\newpage
Для рассмотренных начальных условий синтезированный регулятор справляется с задачей стабилизации. Кроме того, амплитуда компонент вектора состояния минимальна (рисунки \ref{6_lqr_n1}, \ref{6_lqr_n2}, \ref{6_lqr_n3}, \ref{6_lqr_n4}).

\section{Исследование линейно-квадратичного регулятора}

Исследуем влияние весовых матриц LQR-регулятора на маскимальное отклонение маятника от вертикали, максимальное горизонтальное смещение тележки и максимальное значение управляющего сигнала при управлении нелинейной системой. Результаты представим в виде таблицы \ref{6_tab_1}.

\begin{table}[h]
	\centering
	\caption{Результаты моделирования при разных значениях весовых матриц.}
	\label{6_tab_1}
	\begin{tabular}{ccccc}
		\toprule
		$Q$, diag & $R$ & $\max |\varphi|$ & $\max |a|$ & $\max |u|$ \\
		\midrule
		1  & 10  &  0.01  &  1.43  &  77  \\
		10  & 10 &  0.01  &  0.81  &  78  \\
		25 & 10&  0.01  &  0.65  &  79  \\
		50  &10&   0.01  &  0.55&  80 \\
		50  &1&   0.01  &  0.32 &  83  \\
		25  &1&   0.01  &  0.37 &  82  \\
		1  &1&   0.01  &  0.81 &  78 \\
		\bottomrule
	\end{tabular}
\end{table}

Заметим, что для двух наборов, состоящих из одинаковых $Q$ и $R$, показатели $\max |\varphi|$, $\max |a|$ и $\max |u|$ для одного набора совпадают с соответствующими показателями другого набора. Уменьшение $\max |a|$ происходит одновременно с повышением $\max |u|$.

\section{Синтез фильтра Калмана}


\section{LQG для линейной модели}


\section{LQG для нелинейной модели}


\endinput